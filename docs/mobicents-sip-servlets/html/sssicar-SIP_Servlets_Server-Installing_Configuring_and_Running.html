<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory">Chapter 2. SIP Servlets Server-Installing, Configuring and Running</title><link rel="stylesheet" href="css/jbossorg.css" type="text/css"/><meta xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" name="generator" content="DocBook XSL Stylesheets V1.74.0"/><link rel="home" href="index.html" title="SIP Servlets Server User Guide"/><link rel="up" href="index.html" title="SIP Servlets Server User Guide"/><link rel="prev" href="ittsss-Introduction_to_the_SIP_Servlets_Server.html" title="Chapter 1. Introduction to the SIP Servlets Server"/><link rel="next" href="sssicar-SIP_Servlets_Server-Application-Router.html" title="Chapter 3. Application Router"/></head><body><p id="title"><a href="http://www.jboss.org" class="site_href"><strong>JBoss.org</strong></a><a href="http://docs.jboss.org/" class="doc_href"><strong>Community Documentation</strong></a></p><ul class="docnav"><li class="previous"><a accesskey="p" href="ittsss-Introduction_to_the_SIP_Servlets_Server.html"><strong>Prev</strong></a></li><li class="next"><a accesskey="n" href="sssicar-SIP_Servlets_Server-Application-Router.html"><strong>Next</strong></a></li></ul><div class="chapter" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="sssicar-SIP_Servlets_Server-Installing_Configuring_and_Running"/>Chapter 2. SIP Servlets Server-Installing, Configuring and Running</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="sssicar-SIP_Servlets_Server-Installing_Configuring_and_Running.html#bssswjicar-binary-SIP_Servlets_Server_with_JBoss-Installing_Configuring_and_Running">2.1. SIP Servlet-Enabled JBoss Application Server: Installing, Configuring and Running</a></span></dt><dd><dl><dt><span class="section"><a href="sssicar-SIP_Servlets_Server-Installing_Configuring_and_Running.html#d0e700">2.1.1. Java Development Kit (JDK): Installing, Configuring and Running</a></span></dt><dt><span class="section"><a href="sssicar-SIP_Servlets_Server-Installing_Configuring_and_Running.html#bssswjicar-binary-SIP_Servlets_Server_with_JBoss-PreInstall_Requirements_and_Prerequisites">2.1.2. Pre-install Requirements and Prerequisites</a></span></dt><dt><span class="section"><a href="sssicar-SIP_Servlets_Server-Installing_Configuring_and_Running.html#bssswjicar-binary-SIP_Servlets_Server_with_JBoss-Downloading">2.1.3. Downloading</a></span></dt><dt><span class="section"><a href="sssicar-SIP_Servlets_Server-Installing_Configuring_and_Running.html#bssswjicar-binary-SIP_Servlets_Server_with_JBoss-Installing">2.1.4. Installing</a></span></dt><dt><span class="section"><a href="sssicar-SIP_Servlets_Server-Installing_Configuring_and_Running.html#bssswjicar-binary-SIP_Servlets_Server_with_JBoss-Setting_the_JBOSS_HOME_Environment_Variable">2.1.5. Setting the JBOSS_HOME Environment Variable</a></span></dt><dt><span class="section"><a href="sssicar-SIP_Servlets_Server-Installing_Configuring_and_Running.html#bssswjicar-binary-SIP_Servlets_Server_with_JBoss-Configuring">2.1.6. Configuring</a></span></dt><dt><span class="section"><a href="sssicar-SIP_Servlets_Server-Installing_Configuring_and_Running.html#bssswjicar-binary-SIP_Servlets_Server_with_JBoss-Running">2.1.7. Running</a></span></dt><dt><span class="section"><a href="sssicar-SIP_Servlets_Server-Installing_Configuring_and_Running.html#bssswjicar-binary-SIP_Servlets_Server_with_JBoss-Using">2.1.8. Using</a></span></dt><dt><span class="section"><a href="sssicar-SIP_Servlets_Server-Installing_Configuring_and_Running.html#d0e1678">2.1.9. Testing</a></span></dt><dt><span class="section"><a href="sssicar-SIP_Servlets_Server-Installing_Configuring_and_Running.html#bssswjicar-binary-SIP_Servlets_Server_with_JBoss-Stopping">2.1.10. Stopping</a></span></dt><dt><span class="section"><a href="sssicar-SIP_Servlets_Server-Installing_Configuring_and_Running.html#bssswjicar-binary-SIP_Servlets_Server_with_JBoss-Uninstalling">2.1.11. Uninstalling</a></span></dt></dl></dd><dt><span class="section"><a href="sssicar-SIP_Servlets_Server-Installing_Configuring_and_Running.html#bssswticar-SIP_Servlets_Server_with_Tomcat-Installing_Configuring_and_Running">2.2. SIP Servlet-Enabled Tomcat Servlet Container: Installing, Configuring and Running</a></span></dt><dd><dl><dt><span class="section"><a href="sssicar-SIP_Servlets_Server-Installing_Configuring_and_Running.html#d0e1880">2.2.1. Java Development Kit (JDK): Installing, Configuring and Running</a></span></dt><dt><span class="section"><a href="sssicar-SIP_Servlets_Server-Installing_Configuring_and_Running.html#bssswticar-binary-SIP_Servlets_Server_with_Tomcat-PreInstall_Requirements_and_Prerequisites">2.2.2. Pre-Install Requirements and Prerequisites</a></span></dt><dt><span class="section"><a href="sssicar-SIP_Servlets_Server-Installing_Configuring_and_Running.html#bssswticar-binary-SIP_Servlets_Server_with_Tomcat-Downloading">2.2.3. Downloading</a></span></dt><dt><span class="section"><a href="sssicar-SIP_Servlets_Server-Installing_Configuring_and_Running.html#bssswticar-binary-SIP_Servlets_Server_with_Tomcat-Installing">2.2.4. Installing</a></span></dt><dt><span class="section"><a href="sssicar-SIP_Servlets_Server-Installing_Configuring_and_Running.html#section-SIP_Servlets_Server_with_Tomcat-Setting_the_CATALINA_HOME_Environment_Variable">2.2.5. Setting the CATALINA_HOME Environment Variable</a></span></dt><dt><span class="section"><a href="sssicar-SIP_Servlets_Server-Installing_Configuring_and_Running.html#bssswticar-binary-SIP_Servlets_Server_with_Tomcat-Configuring">2.2.6. Configuring</a></span></dt><dt><span class="section"><a href="sssicar-SIP_Servlets_Server-Installing_Configuring_and_Running.html#bssswticar-binary-SIP_Servlets_Server_with_Tomcat-Running">2.2.7. Running</a></span></dt><dt><span class="section"><a href="sssicar-SIP_Servlets_Server-Installing_Configuring_and_Running.html#bssswticar-binary-SIP_Servlets_Server_with_Tomcat-Stopping">2.2.8. Stopping</a></span></dt><dt><span class="section"><a href="sssicar-SIP_Servlets_Server-Installing_Configuring_and_Running.html#bssswticar-binary-SIP_Servlets_Server-Using">2.2.9. Using</a></span></dt><dt><span class="section"><a href="sssicar-SIP_Servlets_Server-Installing_Configuring_and_Running.html#bssswticar-binary-SIP_Servlets_Server_with_Tomcat-Testing">2.2.10. Testing</a></span></dt><dt><span class="section"><a href="sssicar-SIP_Servlets_Server-Installing_Configuring_and_Running.html#bssswticar-binary-SIP_Servlets_Server_with_Tomcat-Uninstalling">2.2.11. Uninstalling</a></span></dt></dl></dd><dt><span class="section"><a href="sssicar-SIP_Servlets_Server-Installing_Configuring_and_Running.html#bsssc-binary-SIP_Servlets_Server-Configuring">2.3. Configuring</a></span></dt><dd><dl><dt><span class="section"><a href="sssicar-SIP_Servlets_Server-Installing_Configuring_and_Running.html#bsssc-binary-SIP_Servlets_Server-Adding_SIP_Connectors">2.3.1. Configuring SIP Connectors</a></span></dt><dt><span class="section"><a href="sssicar-SIP_Servlets_Server-Installing_Configuring_and_Running.html#bsssc-binary-SIP_Servlets_Server-Configuring_Application_Routing">2.3.2. Application Routing and Service Configuration</a></span></dt><dt><span class="section"><a href="sssicar-SIP_Servlets_Server-Installing_Configuring_and_Running.html#bsssc-binary-SIP_Servlets_Server-Configuring_Logging">2.3.3. SIP Servlets Server Logging</a></span></dt></dl></dd></dl></div><p/><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="bssswjicar-binary-SIP_Servlets_Server_with_JBoss-Installing_Configuring_and_Running"/>2.1. SIP Servlet-Enabled JBoss Application Server: Installing, Configuring and Running</h2></div></div></div><p>The Mobicents SIP Servlets Server can run on either the JBoss Application Server or the Tomcat Servlet Container. This section details how to install the SIP Servlets Server on top of the JBoss Application Server. For installation instructions for the Tomcat Servlet Container, refer to <a class="xref" href="sssicar-SIP_Servlets_Server-Installing_Configuring_and_Running.html#bssswticar-SIP_Servlets_Server_with_Tomcat-Installing_Configuring_and_Running" title="2.2. SIP Servlet-Enabled Tomcat Servlet Container: Installing, Configuring and Running">Section 2.2, “SIP Servlet-Enabled Tomcat Servlet Container: Installing, Configuring and Running”</a>
 </p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>Note</h2><p>It is recommended that the SIP Servlets Server is run on the JBoss platform.  Some functionality, including the ability to execute some SIP Extension examples, is not available in the Tomcat version.</p></div><h5 xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="formalpara">Differences Between a Standard JBoss Installation and the Mobicents SIP Servlets Version</h5><p class="formalpara">Provided here is a list of differences between a standard JBoss Application Server installation one customized for SIP Servlets. The differences include:</p><div class="itemizedlist"><ul><li><p>The <code class="filename">server/default/deploy</code> directory contains both HTTP and SIP Servlet applications.</p></li><li><p>The <code class="filename">server/default/deploy/jbossweb.sar</code> units have been modified to provide extended classes to the standard JBoss container classes, in order to allow SIP applications to be loaded and the SIP stack to be started.</p></li><li><p>The <code class="filename">server/default/deploy/jbossweb.sar</code> <code class="filename">context.xml</code> files have been modified to allow the extended manager to manage SIP sessions and SIP application sessions in addition to HTTP sessions.</p></li><li><p>The <code class="filename">server/default/deploy/jbossweb.sar/</code> <code class="filename">server.xml</code> file has been modified to provide extended classes to common JBoss Web containers.  The classes allow SIP applications to be loaded, and the SIP stack to be started.</p></li><li><p>The <code class="filename">server/default/deploy/jbossweb.sar/</code> <code class="filename">jboss-beans.xml</code> file has been modified to allow the JBoss container to process SIP messages.</p></li><li><p>The <code class="filename">server/default/deployers/</code> <code class="filename">metadata-deployer-jboss-beans.xml</code> file has been modified to allow JBoss to parse sip.xml deployment descriptors and SIP metadata annotations.</p></li><li><p>The <code class="filename">server/default/deployers/jbossweb.deployer/META-INF/war-deployers-jboss-beans.xml</code> file have been modified so that it is now possible for JBoss containers to correctly deploy SIP servlets and converged applications.</p></li><li><p>A <code class="filename">dars</code> directory containing all of the Default Application Router (DAR) properties files for using the various SIP Servlets applications (which come bundled with the release) has been added to the <code class="filename">server/default/conf</code> directory.</p></li><li><p>Additional JAR files have been added to enable SIP Servlet functionality; these are located in the <code class="filename">server/default/deploy/jbossweb.sar/</code>, <code class="filename">server/default/deployers/jbossweb.deployer/</code> and <code class="filename">common/lib</code>directories.</p></li></ul></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e700"/>2.1.1. Java Development Kit (<acronym class="acronym">JDK</acronym>): Installing, Configuring and Running</h3></div></div></div><p>
		The <span class="application"><strong>Mobicents Platform</strong></span> is written in Java; therefore, before running any <span class="application"><strong>Mobicents</strong></span> server, you must have a working Java Runtime Environment (<acronym class="acronym">JRE</acronym>) or Java Development Kit (<acronym class="acronym">JDK</acronym>) installed on your system. In addition, the JRE or JDK you are using to run <span class="application"><strong>Mobicents</strong></span> must be version 5 or higher<sup>[<a id="d0e723" href="#ftn.d0e723" class="footnote">1</a>]</sup>.
	</p><h5 xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="formalpara">Should I Install the JRE or JDK?</h5><p class="formalpara">
			Although you can run <span class="application"><strong>Mobicents</strong></span> servers using the Java Runtime Environment, we assume that most users are developers interested in developing Java-based, <span class="application"><strong>Mobicents</strong></span>-driven solutions. Therefore, in this guide we take the tact of showing how to install the full Java Development Kit.
		</p><h5 xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="formalpara">Should I Install the 32-Bit or the 64-Bit JDK, and Does It Matter?</h5><p class="formalpara">
			Briefly stated: if you are running on a 64-Bit Linux or Windows platform, you should consider installing and running the 64-bit JDK over the 32-bit one. Here are some heuristics for determining whether you would rather run the 64-bit Java Virtual Machine (JVM) over its 32-bit cousin for your application:
		</p><div class="itemizedlist"><ul><li><p>
				Wider datapath: the pipe between RAM and CPU is doubled, which improves the performance of memory-bound applications when using a 64-bit JVM.
			</p></li><li><p>
				64-bit memory addressing gives virtually unlimited (1 exabyte) heap allocation. However large heaps affect garbage collection.
			</p></li><li><p>
				Applications that run with more than 1.5 GB of RAM (including free space for garbage collection optimization) should utilize the 64-bit JVM.
			</p></li><li><p>
				Applications that run on a 32-bit JVM and do not require more than minimal heap sizes will gain nothing from a 64-bit JVM. Barring memory issues, 64-bit hardware with the same relative clock speed and architecture is not likely to run Java applications faster than their 32-bit cousin.
			</p></li></ul></div><p>
		Note that the following instructions detail how to download and install the 32-bit JDK, although the steps are nearly identical for installing the 64-bit version.
	</p><h5 xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="formalpara">Downloading</h5><p class="formalpara">
			You can download the Sun JDK 5.0 (Java 2 Development Kit) from Sun's website: <a class="ulink" href="http://java.sun.com/javase/downloads/index_jdk5.jsp">http://java.sun.com/javase/downloads/index_jdk5.jsp</a>. Click on the <span class="guilabel"><strong>Download</strong></span> link next to "JDK 5.0 Update <em class="replaceable"><code>&lt;x&gt;</code></em>" (where <em class="replaceable"><code>&lt;x&gt;</code></em> is the latest minor version release number). On the next page, select your language and platform (both architecture—whether 32- or 64-bit—and operating system), read and agree to the <code class="literal">Java Development Kit 5.0 License Agreement</code>, and proceed to the download page.
		</p><p>
		The Sun website will present two download alternatives to you: one is an RPM inside a self-extracting file (for example, <code class="filename">jdk-1_5_0_16-linux-i586-rpm.bin</code>), and the other is merely a self-extracting file (e.g. <code class="filename">jdk-1_5_0_16-linux-i586.bin</code>). If you are installing the JDK on Red Hat Enterprise Linux, Fedora, or another RPM-based Linux system, we suggest that you download the self-extracting file containing the RPM package, which will set up and use the SysV service scripts in addition to installing the JDK. We also suggest installing the self-extracting RPM file if you will be running <span class="application"><strong>Mobicents</strong></span> in a production environment.
	</p><h5 xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="formalpara">Installing</h5><p class="formalpara">
			The following procedures detail how to install the Java Development Kit on both Linux and Windows.
		</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="procedure"><a id="d0e801"/><p class="title"><b>Procedure 2.1. Installing the JDK on Linux</b></p><ul><li><p>
				Regardless of which file you downloaded, you can install it on Linux by simply making sure the file is executable and then running it:
			</p><pre class="screen">~]$ chmod +x "jdk-1_5_0_&lt;minor_version&gt;-linux-&lt;architecture&gt;-rpm.bin"
~]$ ./"jdk-1_5_0_&lt;minor_version&gt;-linux-&lt;architecture&gt;-rpm.bin"</pre></li></ul></div><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>You Installed Using the Non-RPM Installer, but Want the SysV Service Scripts</h2><p>
			If you download the non-RPM self-extracting file (and installed it), and you are running on an RPM-based system, you can still set up the SysV service scripts by downloading and installing one of the <code class="literal">-compat</code> packages from the JPackage project. Remember to download the <code class="literal">-compat</code> package which corresponds correctly to the minor release number of the JDK you installed. The compat packages are available from <a class="ulink" href="ftp://jpackage.hmdc.harvard.edu/JPackage/1.7/generic/RPMS.non-free/">ftp://jpackage.hmdc.harvard.edu/JPackage/1.7/generic/RPMS.non-free/</a>.
		</p></div><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="important"><h2>Important</h2><p>
			You do not need to install a <code class="literal">-compat</code> package in addition to the JDK if you installed the self-extracting RPM file! The <code class="literal">-compat</code> package merely performs the same SysV service script set up that the RPM version of the JDK installer does.
		</p></div><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="procedure"><a id="d0e832"/><p class="title"><b>Procedure 2.2. Installing the JDK on Windows</b></p><ul><li><p>
				Using Explorer, simply double-click the downloaded self-extracting installer and follow the instructions to install the JDK.
			</p></li></ul></div><h5 xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="formalpara">Configuring</h5><p class="formalpara">
			Configuring your system for the JDK consists in two tasks: setting the <code class="envar">JAVA_HOME</code> environment variable, and ensuring that the system is using the proper JDK (or JRE) using the <code class="command">alternatives</code> command. Setting <code class="envar">JAVA_HOME</code> usually overrides the values for <code class="command">java</code>, <code class="command">javac</code> and <code class="command">java_sdk_1.5.0</code> in <code class="command">alternatives</code>, but we will set them all just to be safe and consistent.
		</p><div class="variablelist"><dl><dt><span class="term">Setting the <code class="envar">JAVA_HOME</code> Environment Variable on Generic Linux</span></dt><dd><p>
					After installing the JDK, you must ensure that the <code class="envar">JAVA_HOME</code> environment variable exists and points to the location of your JDK installation.
				</p><h5 xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="formalpara">Setting the <code class="envar">JAVA_HOME</code> Environment Variable on Linux</h5><p class="formalpara">
						You can determine whether <code class="envar">JAVA_HOME</code> is set on your system by <code class="command">echo</code>ing it on the command line:
					</p><pre class="screen">~]$ echo $JAVA_HOME</pre><p>
					If <code class="envar">JAVA_HOME</code> is not set already, then you must set its value to the location of the JDK installation on your system. You can do this by adding two lines to your personal <code class="filename">~/.bashrc</code> configuration file. Open <code class="filename">~/.bashrc</code> (or create it if it doesn't exist) and add a line similar to the following one anywhere inside the file:
				</p><pre class="programlisting">export JAVA_HOME="/usr/lib/jvm/jdk1.5.0_&lt;version&gt;"
</pre><p>
					You should also set this environment variable for any other users who will be running <span class="application"><strong>Mobicents</strong></span> (any environment variables <code class="command">export</code>ed from <code class="filename">~/.bashrc</code> files are local to that user).
				</p></dd><dt><span class="term">Setting <code class="envar">java</code>, <code class="envar">javac</code> and <code class="envar">java_sdk_1.5.0</code> Using the <code class="command">alternatives</code> command </span></dt><dd><h5 xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="formalpara">Selecting the Correct System JVM on Linux using <code class="command">alternatives</code>
					</h5><p class="formalpara">
						On systems with the <code class="command">alternatives</code> command, including Red Hat Enterprise Linux and Fedora, you can easily choose which JDK (or JRE) installation you wish to use, as well as which <code class="command">java</code> and <code class="command">javac</code> executables should be run when called.
					</p><p>
					<span class="emphasis"><em>As the root user</em></span>, call <code class="command">/usr/sbin/alternatives</code> with the <code class="option">--config java</code> option to select between JDKs and JREs installed on your system:
				</p><pre class="programlisting">root@localhost ~]$ /usr/sbin/alternatives --config java

There are 3 programs which provide 'java'.

  Selection    Command
-----------------------------------------------
   1           /usr/lib/jvm/jre-1.5.0-gcj/bin/java
   2           /usr/lib/jvm/jre-1.6.0-sun/bin/java
*+ 3         /usr/lib/jvm/jre-1.5.0-sun/bin/java


Enter to keep the current selection[+], or type selection number:
</pre><p>
					In our case, we want to use the Sun JDK, version 5, that we downloaded and installed, to run the <code class="command">java</code> executable. In the <code class="command">alternatives</code> information printout above, a plus (<code class="literal">+</code>) next to a number indicates the one currently being used. As per <code class="command">alternatives</code>' instructions, pressing <span class="keycap"><strong>Enter</strong></span> will simply keep the current JVM, or you can enter the number corresponding to the JVM you would prefer to use.
				</p><p>
					Repeat the procedure above for the <code class="command">javac</code> command and the <code class="literal">java_sdk_1.5.0</code> environment variable, <span class="emphasis"><em>as the root user</em></span>:
				</p><pre class="screen">~]$ /usr/sbin/alternatives --config javac</pre><pre class="screen">~]$ /usr/sbin/alternatives --config java_sdk_1.5.0</pre></dd><dt><span class="term">Setting the <code class="envar">JAVA_HOME</code> Environment Variable on Windows</span></dt><dd><p>
					For information on how to set environment variables in Windows, refer to <a class="ulink" href="http://support.microsoft.com/kb/931715">http://support.microsoft.com/kb/931715</a>.
				</p></dd></dl></div><h5 xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="formalpara">Testing</h5><p class="formalpara">
			Finally, to make sure that you are using the correct JDK or Java version (5 or higher), and that the java executable is in your <code class="envar">PATH</code>, run the <code class="command">java <code class="option">-version</code>
			</code> command in the terminal from your home directory:
		</p><pre class="screen">~]$ java -version
java version "1.5.0_16"
Java(TM) 2 Runtime Environment, Standard Edition (build 1.5.0_16-b03)
Java HotSpot(TM) Client VM (build 1.5.0_16-b03, mixed mode, sharing)</pre><h5 xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="formalpara">Uninstalling</h5><p class="formalpara">
			There is usually no reason (other than space concerns) to remove a particular JDK from your system, given that you can switch between JDKs and JREs easily using <code class="command">alternatives</code>, and/or by setting <code class="envar">JAVA_HOME</code>.
		</p><h5 xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="formalpara">Uninstalling the JDK on Linux</h5><p class="formalpara">
			On RPM-based systems, you can uninstall the JDK using the <code class="command">yum <code class="option">remove &lt;jdk_rpm_name&gt;</code>
			</code> command.
		</p><h5 xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="formalpara">Uninstalling the JDK on Windows</h5><p class="formalpara">
			On Windows systems, check the JDK entry in the <code class="literal">Start</code> menu for an uninstall command, or use <code class="literal">Add/Remove Programs</code>.
		</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="bssswjicar-binary-SIP_Servlets_Server_with_JBoss-PreInstall_Requirements_and_Prerequisites"/>2.1.2. Pre-install Requirements and Prerequisites</h3></div></div></div><p/><div class="variablelist"><a id="bssswjicar-binary-SIP_Servlets_Server_with_JBoss-Hardware_Requirements"/><p class="title"><b>Hardware Requirements</b></p><dl><dt><span class="term">Sufficient Disk Space</span></dt><dd><p>Once unzipped, version 1.4.0.FINAL of the MSS for JBoss binary release requires a minimum of 20MB free disk space.</p></dd><dt><span class="term">Anything Java Itself Will Run On</span></dt><dd><p>MSS for JBoss is 100% Java and will run on the same hardware that the JBoss Application Server runs on.</p></dd></dl></div><div class="variablelist"><a id="bssswjicar-binary-SIP_Servlets_Server_with_JBoss-Software_Prerequisites"/><p class="title"><b>Software Prerequisites</b></p><dl><dt><span class="term">JDK 5 or Higher</span></dt><dd><p>A working installation of the Java Development Kit (&lt;acronym&gt;JDK&lt;/acronym&gt;) version 5 or higher is currently required in order to run MSS for JBoss binary distribution. For instructions on how to install the JDK, refer to <a class="xref" href="sssicar-SIP_Servlets_Server-Installing_Configuring_and_Running.html#bssswjicar-binary-SIP_Servlets_Server_with_JBoss-Installing" title="2.1.4. Installing">Section 2.1.4, “Installing”</a></p></dd></dl></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="bssswjicar-binary-SIP_Servlets_Server_with_JBoss-Downloading"/>2.1.3. Downloading</h3></div></div></div><p>The latest version of Mobicents SIP Servlets for JBoss is available from <a class="ulink" href="http://www.mobicents.org/mss-downloads.html">http://www.mobicents.org/mss-downloads.html</a>.  The top row of the table contains the latest version.</p><p>Each version of the SIP Servlets Server is comprised of two separate binary distribution files: one which is MSS for JBoss, and the other which is MSS for Tomcat.  Download SIP Servlets Server for JBoss and continue with the following instructions.</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="bssswjicar-binary-SIP_Servlets_Server_with_JBoss-Installing"/>2.1.4. Installing</h3></div></div></div><p>Once the requirements and prerequisites have been met and you have downloaded the binary distribution zip file, you are ready to install the MSS for JBoss binary distribution.  Follow the instructions below for the selected platform, whether Linux or Windows.</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><a id="bssswjicar--binary-SIP_Servlets_Server_with_JBoss-Use_Version_Numbers_Relevant_to_Your_Installation"/><h2>Version Numbers</h2><p>For clarity, the command line instructions presented in this chapter use specific version numbers and directory names.  Ensure this information is substituted with the binary distribution's version numbers and file names.</p></div><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="procedure"><a id="d0e1109"/><p class="title"><b>Procedure 2.3. Installing the MSS for JBoss Binary Distribution on Linux</b></p><p>It is assumed that the downloaded archive is saved in the home directory, and that a terminal window is open displaying the home directory</p><ol class="1"><li><p>Create a subdirectory to extract the MSS for JBoss files into.  For ease of identification, it is recommended that the version number of the binary is included in this directory name.</p><pre class="screen">~]$ mkdir "mss-jboss-&lt;version&gt;"</pre></li><li><p>Move the downloaded zip file into the directory.</p><pre class="screen">~]$ mv "mss-1.3.1-apache-tomcat-6.0.20-1007051527.zip" "mss-jboss-&lt;version&gt;"</pre></li><li><p>Move into the directory.</p><pre class="screen">~]$ cd "mss-jboss-&lt;version&gt;"</pre></li><li><p>Extract the files into the current directory by executing one of the following commands.</p><div class="itemizedlist"><ul><li><p>Java: </p><pre class="screen">mss-jboss-&lt;version&gt;]$ jar -xvf "mss-1.3.1-apache-tomcat-6.0.20-1007051527.zip"</pre></li><li><p>Linux: </p><pre class="screen">mss-jboss-&lt;version&gt;]$ unzip "mss-1.3.1-apache-tomcat-6.0.20-1007051527.zip"</pre></li></ul></div><div class="note"><h2>Note</h2><p>You can also use <code class="command">unzip</code>'-d &lt;unzip_to_location&gt; to extract the zip file's contents to a location other than the current directory.</p></div></li><li><p>To free disk space, you may want to delete the zip file once you've extracted its contents:</p><pre class="screen">mss-jboss-&lt;version&gt;]$ rm "mss-1.3.1-apache-tomcat-6.0.20-1007051527.zip"</pre></li></ol></div><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="procedure"><a id="d0e1154"/><p class="title"><b>Procedure 2.4. Installing the MSS for JBoss Binary Distribution on <span class="productname">Windows</span></b></p><p>For this procedure, it is assumed that the downloaded archive is saved in the <code class="filename">My Downloads</code> folder.</p><ol class="1"><li><p>Create a directory in <code class="filename">My Downloads</code> to extract the zip file's contents into.  For ease of identification, it is recommended that the version number of the binary is included in the folder name.  For example, <code class="filename">MSS-jboss-&lt;version&gt;</code>.</p></li><li><p>Extract the contents of the archive, specifying the destination folder as the one created in the previous step.</p></li><li><p>Alternatively, execute the <code class="command">jar -xvf</code> command to extract the binary distribution files from the zip archive.</p><div class="orderedlist"><ol><li><p>Move the downloaded zip file from <code class="filename">My Downloads</code> to the folder created in the previous step.</p></li><li><p>Open the Windows Command Prompt and navigate to the folder that contains the archive using the <code class="command">cd</code> command</p></li><li><p>Execute the <code class="command">jar -xvf</code> command to extract the archive contents into the current folder.</p><pre class="screen">C:\Users\&lt;user&gt;\My Downloads\mss-jboss-&lt;version&gt;&gt;jar -xvf "mss-1.3.1-apache-tomcat-6.0.20-1007051527.zip"</pre></li></ol></div></li><li><p>It is recommended that the folder holding the MSS for JBoss files (in this example, the folder named <code class="filename">mss-jboss-<em class="replaceable"><code>&lt;version&gt;</code></em></code>) is moved to a user-defined location for storing executable programs.  For example, the <code class="filename">Program Files</code> folder.</p></li><li><p>Consider deleting the archive, if free disk space is an issue.</p><pre class="screen">C:\Users\&lt;user&gt;\My Downloads\mss-jboss-&lt;version&gt;&gt;delete "mss-1.3.1-apache-tomcat-6.0.20-1007051527.zip"</pre></li></ol></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="bssswjicar-binary-SIP_Servlets_Server_with_JBoss-Setting_the_JBOSS_HOME_Environment_Variable"/>2.1.5. Setting the JBOSS_HOME Environment Variable</h3></div></div></div><p>Configuring MSS for JBoss consists of setting the <code class="envar">JBOSS_HOME</code> environment variable and optionally customizing the MSS for JBoss server by adding SIP Connectors, configuring the application router, and logging.</p><p>After setting <code class="envar">JBOSS_HOME</code> according to the instructions in the following section, refer to <a class="xref" href="sssicar-SIP_Servlets_Server-Installing_Configuring_and_Running.html#bsssc-binary-SIP_Servlets_Server-Configuring" title="2.3. Configuring">Section 2.3, “Configuring”</a> to learn how to configure MSS for JBoss.</p><p>Alternatively, after having set <code class="envar">JBOSS_HOME</code>, the MSS for JBoss server can be run.  Return to this section to configure it later. </p><div class="section" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="d0e1239"/>2.1.5.1. Setting the JBOSS_HOME Environment Variable</h4></div></div></div><p>
		The <span class="application"><strong>Mobicents Platform</strong></span> (<span class="application"><strong>Mobicents</strong></span>) is built on top of the <span class="application"><strong>JBoss Application Server</strong></span> (<span class="application"><strong>JBoss AS</strong></span>). You do not need to set the <code class="envar">JBOSS_HOME</code> environment variable to run any of the <span class="application"><strong>Mobicents Platform</strong></span> servers <span class="emphasis"><em>unless</em></span> <code class="envar">JBOSS_HOME</code> is <span class="emphasis"><em>already</em></span> set.
	</p><p>The best way to know for sure whether <code class="envar">JBOSS_HOME</code> was set previously or not is to perform a simple check which may save you time and frustration.</p><h5 xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="formalpara">Checking to See If JBOSS_HOME is Set on Unix</h5><p class="formalpara">At the command line, <code class="command">echo</code>
			<strong class="userinput"><code>$JBOSS_HOME</code></strong> to see if it is currently defined in your environment:</p><pre class="screen">~]$ echo $JBOSS_HOME</pre><p>The <span class="application"><strong>Mobicents Platform</strong></span> and most Mobicents servers are built on top of the <span class="application"><strong>JBoss Application Server</strong></span> (<span class="application"><strong>JBoss AS</strong></span>). When the <span class="application"><strong>Mobicents Platform</strong></span> or Mobicents servers are built <span class="emphasis"><em>from source</em></span>, then <code class="envar">JBOSS_HOME</code> <span class="emphasis"><em>must</em></span> be set, because the Mobicents files are installed into (or “<span class="quote">over top of</span>” if you prefer) a clean <span class="application"><strong>JBoss AS</strong></span> installation, and the build process assumes that the location pointed to by the <code class="envar">JBOSS_HOME</code> environment variable at the time of building is the <span class="application"><strong>JBoss AS</strong></span> installation into which you want it to install the Mobicents files.
	</p><p>This guide does not detail building the <span class="application"><strong>Mobicents Platform</strong></span> or any Mobicents servers from source. It is nevertheless useful to understand the role played by <span class="application"><strong>JBoss AS</strong></span> and <code class="envar">JBOSS_HOME</code> in the Mobicents ecosystem.</p><p>
		The immediately-following section considers whether you need to set <code class="envar">JBOSS_HOME</code> at all and, if so, when. The subsequent sections detail how to set <code class="envar">JBOSS_HOME</code> on Unix and Windows
	</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="important"><h2>Important</h2><p>
			Even if you fall into the category below of <span class="emphasis"><em>not needing</em></span> to set <code class="envar">JBOSS_HOME</code>, you may want to for various reasons anyway. Also, even if you are instructed that you do <span class="emphasis"><em>not need</em></span> to set <code class="envar">JBOSS_HOME</code>, it is good practice nonetheless to check and make sure that <code class="envar">JBOSS_HOME</code> actually <span class="emphasis"><em>isn't</em></span> set or defined on your system for some reason. This can save you both time and frustration.
		</p></div><h5><a id="d0e1365"/>You <span class="emphasis"><em>DO NOT NEED</em></span> to set <code class="envar">JBOSS_HOME</code> if...</h5><div class="itemizedlist"><ul><li><p>
				...you have installed the <span class="application"><strong>Mobicents Platform</strong></span> binary distribution.
			</p></li><li><p>
				...you have installed a Mobicents server binary distribution <span class="emphasis"><em>which bundles <span class="application"><strong>JBoss AS</strong></span>.</em></span>
			</p></li></ul></div><h5><a id="d0e1389"/>You <span class="emphasis"><em>MUST</em></span> set <code class="envar">JBOSS_HOME</code> if...</h5><div class="itemizedlist"><ul><li><p>
				...you are installing the <span class="application"><strong>Mobicents Platform</strong></span> or any of the Mobicents servers <span class="emphasis"><em>from source</em></span>.
			</p></li><li><p>
				...you are installing the <span class="application"><strong>Mobicents Platform</strong></span> binary distribution, or one of the Mobicents server binary distributions, which <span class="emphasis"><em>do not</em></span> bundle <span class="application"><strong>JBoss AS</strong></span>.
			</p></li></ul></div><p>
		Naturally, if you installed the <span class="application"><strong>Mobicents Platform</strong></span> or one of the Mobicents server binary releases which <span class="emphasis"><em>do not</em></span> bundle <span class="application"><strong>JBoss AS</strong></span>, yet requires it to run, then you should <a class="ulink" href="http://docs.jboss.org/jbossas/docs/Installation_And_Getting_Started_Guide/5/html_single/index.html">install <span class="application"><strong>JBoss AS</strong></span>
		</a> before setting <code class="envar">JBOSS_HOME</code> or proceeding with anything else.
	</p><h5 xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="formalpara">Setting the JBOSS_HOME Environment Variable on Unix</h5><p class="formalpara">
			The <code class="envar">JBOSS_HOME</code> environment variable must point to the directory which contains all of the files for the <span><span class="application"><strong>Mobicents Platform</strong></span> or individual Mobicents server</span> that you installed. As another hint, this topmost directory contains a <code class="filename">bin</code> subdirectory.
		</p><p>
		Setting <code class="envar">JBOSS_HOME</code> in your personal <code class="filename">~/.bashrc</code> startup script carries the advantage of retaining effect over reboots. Each time you log in, the environment variable is sure to be set for you, as a user. On Unix, it is possible to set <code class="envar">JBOSS_HOME</code> as a system-wide environment variable, by defining it in <code class="filename">/etc/bashrc</code>, but this method is neither recommended nor detailed in these instructions.
	</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="procedure"><a id="d0e1469"/><p class="title"><b>Procedure 2.5. To Set JBOSS_HOME on Unix...</b></p><ol class="1"><li><p>
				Open the <code class="filename">~/.bashrc</code> startup script, which is a hidden file in your home directory, in a text editor, and insert the following line on its own line while substituting for the actual install location on your system:
			</p><pre class="screen">export JBOSS_HOME="/home/&lt;username&gt;/&lt;path&gt;/&lt;to&gt;/&lt;install_directory&gt;"</pre></li><li><p>
				Save and close the <code class="filename">.bashrc</code> startup script.
			</p></li><li><p>
				You should <code class="command">source</code> the <code class="filename">.bashrc</code> script to force your change to take effect, so that <code class="envar">JBOSS_HOME</code> becomes set for the current session<sup>[<a id="d0e1499" href="#ftn.d0e1499" class="footnote">2</a>]</sup>.
			</p><pre class="screen">~]$ source ~/.bashrc</pre></li><li><p>
				Finally, ensure that <code class="envar">JBOSS_HOME</code> is set in the current session, and actually points to the correct location:
			</p><div class="note"><h2>Note</h2><p>
					The command line usage below is based upon a binary installation of the <span class="application"><strong>Mobicents Platform</strong></span>. In this sample output, <code class="envar">JBOSS_HOME</code> has been set correctly to the <em class="replaceable"><code>topmost_directory</code></em> of the <span class="application"><strong>Mobicents</strong></span> installation. Note that if you are installing one of the standalone <span class="application"><strong>Mobicents</strong></span> servers (with <span class="application"><strong>JBoss AS</strong></span> bundled!), then <code class="envar">JBOSS_HOME</code> would point to the <em class="replaceable"><code>topmost_directory</code></em> of your server installation.
				</p></div><pre class="screen">~]$ echo $JBOSS_HOME
/home/silas/mobicents-all-1.2.1.GA-jboss-4.2.3.GA/jboss/</pre></li></ol></div><h5 xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="formalpara">Setting the JBOSS_HOME Environment Variable on Windows</h5><p class="formalpara">
			The <code class="envar">JBOSS_HOME</code> environment variable must point to the directory which contains all of the files for the <span>Mobicents Platform or individual Mobicents server</span> that you installed. As another hint, this topmost directory contains a <code class="filename">bin</code> subdirectory.
		</p><p>
		For information on how to set environment variables in recent versions of Windows, refer to <a class="ulink" href="http://support.microsoft.com/kb/931715">http://support.microsoft.com/kb/931715</a>.
	</p></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="bssswjicar-binary-SIP_Servlets_Server_with_JBoss-Configuring"/>2.1.6. Configuring</h3></div></div></div><p>To configure MSS for JBoss, refer to <a class="xref" href="sssicar-SIP_Servlets_Server-Installing_Configuring_and_Running.html#bsssc-binary-SIP_Servlets_Server-Configuring" title="2.3. Configuring">Section 2.3, “Configuring”</a>.</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="bssswjicar-binary-SIP_Servlets_Server_with_JBoss-Running"/>2.1.7. Running</h3></div></div></div><p>To start the server, execute one of the startup scripts in the <code class="filename">bin</code> directory (on Linux or Windows), or by double-clicking the <code class="filename">run.bat</code> executable batch file in that same directory (on Windows only).  It is recommended that the JBoss Application Server is started using the terminal or Command Prompt because the messages displayed during startup can be used to debug, and subsequently correct, any problems.  In the Linux terminal or Command Prompt, a successfully started server will return the following information :</p><pre class="programlisting">22:39:07,598 INFO  [SipApplicationDispatcherImpl] Mobicents Sip Servlets &lt;version&gt; - revision &lt;rev number&gt; started.</pre><p>Detailed instructions are given below, arranged by platform.</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="procedure"><a id="d0e1594"/><p class="title"><b>Procedure 2.6. Running MSS for JBoss on Linux</b></p><ol class="1"><li><p>Change the working directory to MSS for JBoss's installation directory (the one in which the zip file's contents was extracted to)</p><pre class="screen">downloads]$ cd "mss-jboss-&lt;version&gt;"</pre></li><li><p>(Optional) Ensure that the <code class="filename">bin/run.sh</code> start script is executable.</p><pre class="screen">mss-jboss-&lt;version&gt;]$ chmod +x bin/run.sh</pre></li><li><p>Execute the <code class="filename">run.sh</code> Bourne shell script.</p><pre class="screen">mss-jboss-&lt;version&gt;]$ ./bin/run.sh</pre></li></ol></div><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>Note</h2><p>Instead of executing the Bourne shell script to start the server, the <code class="filename">run.jar</code> executable Java archive can be executed from the <code class="filename">bin</code> directory:</p><pre class="screen">mss-jboss-&lt;version&gt;]$ java -jar bin/run.jar</pre></div><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="procedure"><a id="d0e1629"/><p class="title"><b>Procedure 2.7. Running MSS for JBoss on <span class="productname">Windows</span></b></p><p>There are several ways to start MSS for JBoss on Windows. All of the following methods accomplish the same task.</p><ol class="1"><li><p>Using Windows Explorer, navigate to the <code class="filename">bin</code> subdirectory in the installation directory.</p></li><li><p>The preferred way to start MSS for JBoss from the Command Prompt.  The command line interface displays details of the startup process, including any problems encountered during the startup process.</p><p>Open the Command Prompt via the <span class="guilabel"><strong>Start</strong></span> menu and navigate to the correct folder:</p><pre class="screen">C:\Users\&lt;user&gt;My Downloads&gt; cd "mss-jboss-&lt;version&gt;"</pre></li><li><p>Start the JBoss Application Server by executing one of the following files:
        </p><div class="itemizedlist"><ul><li><p><code class="filename">run.bat</code> batch file:</p><pre class="screen">C:\Users\&lt;user&gt;My Downloads\mss-jboss-&lt;version&gt;&gt;bin\run.bat</pre></li><li><p><code class="filename">run.jar</code> executable Java archive:</p><pre class="screen">C:\Users\&lt;user&gt;My Downloads\mss-jboss-&lt;version&gt;&gt;java -jar bin\run.jar</pre></li></ul></div><p>
        </p></li></ol></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="bssswjicar-binary-SIP_Servlets_Server_with_JBoss-Using"/>2.1.8. Using</h3></div></div></div><p>Once the server is running, access the SIP Servlets Management Console by opening <a class="ulink" href="http://localhost:8080/sip-servlets-management/">http://localhost:8080/sip-servlets-management/</a>.</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e1678"/>2.1.9. Testing</h3></div></div></div><p>After installation, there should be one pre-configured sample application deployed in the <code class="literal">default</code> server onfiguration. You can use it to verify that the server is installed and running correctly. The application name is “<span class="quote">org.mobicents.servlet.sip.example.SimpleApplication</span>”. From the Sip Servlets Management Console you can make sure it is subscribed to receive <code class="literal">INVITE</code> and <code class="literal">REGISTER</code> SIP requests.  It is a simple <code class="filename">Click2Call</code> application allowing SIP registration and calling phones from the Web user interface.</p><p>The scenario for this example consists of the following steps:</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="orderedlist"><ol><li><p>Alice and Bob each register a SIP Softphone</p></li><li><p>Alice clicks on the "Call" link to place a call to Bob</p></li><li><p>Alice's phone rings</p></li><li><p>When Alice picks up her phone, Bob's phone rings</p></li><li><p>When Bob answers his phone, the call is connected</p></li><li><p>When one of them hangs up, the other one is also disconnected </p></li></ol></div><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="procedure"><a id="d0e1719"/><p class="title"><b>Procedure 2.8. Testing the Click2Call sample application</b></p><ol class="1"><li><p>Open up a browser to <a class="ulink" href="http://localhost:8080/click2call/">http://localhost:8080/click2call/</a>. If you have no registered SIP clients you will be asked to register at least two.</p></li><li><p>Configure your SIP clients to use the sip servlets server as a register and proxy. (IP address : 127.0.0.1, port: 5080)
By default it will accept any password</p></li><li><p>After the registration you will see a table where each cell will initiate a call between the corresponding clients.</p></li><li><p>Close the calls.</p></li><li><p>Navigate to <a class="ulink" href="http://localhost:8080/click2call/simplecall.html">http://localhost:8080/click2call/simplecall.html</a>, which is a simplified version that doesn't require registered clients.
</p></li><li><p>Enter the URIs of the two SIP phones you just started and click "Submit"</p></li><li><p>The phones should be ringing again. You can pick them up and you will know that the SIP and the HTTP containers are working properly.</p></li></ol></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="bssswjicar-binary-SIP_Servlets_Server_with_JBoss-Stopping"/>2.1.10. Stopping</h3></div></div></div><p>Detailed instructions for stopping the JBoss Application Server are given below, arranged by platform.  If the server is correctly stopped, the following three lines are displayed as the last output in the Linux terminal or Command Prompt:</p><pre class="programlisting">[Server] Shutdown complete
Shutdown complete
Halting VM</pre><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="procedure"><a id="d0e1757"/><p class="title"><b>Procedure 2.9. Stopping MSS for JBoss on Linux</b></p><ol class="1"><li><p>Change the working directory to the binary distribution's install directory.</p><pre class="screen">~]$ cd "mss-jboss-&lt;version&gt;"</pre></li><li><p>(Optional) Ensure that the bin/shutdown.sh start script is executable:</p><pre class="screen">mss-jboss-&lt;version&gt;]$ chmod +x bin/shutdown.sh</pre></li><li><p>Run the <code class="filename">shutdown.sh</code> executable Bourne shell script with the <code class="option">-S</code> option (the short option for <code class="option">--shutdown</code>) as a command line argument:</p><pre class="screen">mss-jboss-&lt;version&gt;]$ ./bin/shutdown.sh -S</pre></li></ol></div><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>Note</h2><p>The <code class="filename">shutdown.jar</code> executable Java archive with the <code class="option">-S</code> option can also be used to shut down the server:</p><pre class="screen">mss-jboss-&lt;version&gt;]$ java -jar bin/shutdown.jar -S</pre></div><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="procedure"><a id="d0e1795"/><p class="title"><b>Procedure 2.10. Stopping mss for JBoss on Windows</b></p><ul><li><p>Stopping the JBoss Application Server on Windows consists in executing either the <code class="filename">shutdown.bat</code> or the <code class="filename">shutdown.jar</code> executable file in the <code class="filename">bin</code> subdirectory of the MSS for JBoss binary distribution. Ensure the <code class="option">-S</code> option (the short option for <code class="option">--shutdown</code>) is included in the command line argument.</p><pre class="screen">C:\Users\&lt;user&gt;\My Downloads\mss-jboss-&lt;version&gt;&gt;bin\shutdown.bat -S</pre><ul>
          <li><p>The <code class="filename">shutdown.jar</code> executable Java archive with the <code class="option">-S</code> option can also be used to shut down the server:</p><pre class="screen">C:\Users\&lt;user&gt;\My Downloads\mss-jboss-&lt;version&gt;&gt;java -jar bin\shutdown.jar -S</pre></li>
        </ul></li></ul></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="bssswjicar-binary-SIP_Servlets_Server_with_JBoss-Uninstalling"/>2.1.11. Uninstalling</h3></div></div></div><p>To uninstall MSS for JBoss, delete the directory containing the binary distribution.</p></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="bssswticar-SIP_Servlets_Server_with_Tomcat-Installing_Configuring_and_Running"/>2.2. SIP Servlet-Enabled Tomcat Servlet Container: Installing, Configuring and Running</h2></div></div></div><p>You can also run Mobicents SIP Servlets on top of the Apache Tomcat Servlet Container. This section provides information on the requirements and prerequisites for running MSS for Tomcat, as well as instructions on how to download, install, configure, run, use, stop, test and uninstall it.</p><p>Keep in mind that not all capabilities provided by running Mobicents SIP Servlets Server on top of the JBoss Application Server are available with MSS for Tomcat. In particular, MSS for Tomcat lacks support for both clustering and failover; MSS for Tomcat nodes can utilize the SIP load balancer, however.</p><p>If you are interested in clustering and failover support, or would rather run the Mobicents SIP Servlets Server on top of the JBoss Application Server, go to <a class="xref" href="sssicar-SIP_Servlets_Server-Installing_Configuring_and_Running.html#bssswjicar-binary-SIP_Servlets_Server_with_JBoss-Installing_Configuring_and_Running" title="2.1. SIP Servlet-Enabled JBoss Application Server: Installing, Configuring and Running">Section 2.1, “SIP Servlet-Enabled JBoss Application Server: Installing, Configuring and Running”</a>.</p><h5 xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="formalpara">Differences Between the Standard Tomcat Installation and One Customized for the SIP Servlets Server</h5><p class="formalpara">Provided here is a list of differences between a standard Tomcat Servlet Container installation and the SIP Servlets Server for Tomcat installation. The differences include:</p><div class="itemizedlist"><ul><li><p>The <code class="filename">server.xml</code> configuration file has been modified to provide extended classes to the standard Tomcat container classes, in order to allow SIP applications to be loaded and the SIP stack started.</p></li><li><p>A <code class="filename">dars</code> directory containing the default applications' router properties files for using the SIP Servlet Click-to-Call application (which comes bundled with the release) has been added to the <code class="filename">conf</code> directory.</p></li><li><p>Additional JAR files which can be found in the <code class="filename">lib</code> directory have been added to enable SIP Servlet functionality.</p></li></ul></div><h3><a id="bssswticar-Installing_the_Java_Development_Kit"/>Installing the Java Development Kit</h3><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e1880"/>2.2.1. Java Development Kit (<acronym class="acronym">JDK</acronym>): Installing, Configuring and Running</h3></div></div></div><p>
		The <span class="application"><strong>Mobicents Platform</strong></span> is written in Java; therefore, before running any <span class="application"><strong>Mobicents</strong></span> server, you must have a working Java Runtime Environment (<acronym class="acronym">JRE</acronym>) or Java Development Kit (<acronym class="acronym">JDK</acronym>) installed on your system. In addition, the JRE or JDK you are using to run <span class="application"><strong>Mobicents</strong></span> must be version 5 or higher<sup>[<a id="d0e1903" href="#ftn.d0e1903" class="footnote">3</a>]</sup>.
	</p><h5 xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="formalpara">Should I Install the JRE or JDK?</h5><p class="formalpara">
			Although you can run <span class="application"><strong>Mobicents</strong></span> servers using the Java Runtime Environment, we assume that most users are developers interested in developing Java-based, <span class="application"><strong>Mobicents</strong></span>-driven solutions. Therefore, in this guide we take the tact of showing how to install the full Java Development Kit.
		</p><h5 xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="formalpara">Should I Install the 32-Bit or the 64-Bit JDK, and Does It Matter?</h5><p class="formalpara">
			Briefly stated: if you are running on a 64-Bit Linux or Windows platform, you should consider installing and running the 64-bit JDK over the 32-bit one. Here are some heuristics for determining whether you would rather run the 64-bit Java Virtual Machine (JVM) over its 32-bit cousin for your application:
		</p><div class="itemizedlist"><ul><li><p>
				Wider datapath: the pipe between RAM and CPU is doubled, which improves the performance of memory-bound applications when using a 64-bit JVM.
			</p></li><li><p>
				64-bit memory addressing gives virtually unlimited (1 exabyte) heap allocation. However large heaps affect garbage collection.
			</p></li><li><p>
				Applications that run with more than 1.5 GB of RAM (including free space for garbage collection optimization) should utilize the 64-bit JVM.
			</p></li><li><p>
				Applications that run on a 32-bit JVM and do not require more than minimal heap sizes will gain nothing from a 64-bit JVM. Barring memory issues, 64-bit hardware with the same relative clock speed and architecture is not likely to run Java applications faster than their 32-bit cousin.
			</p></li></ul></div><p>
		Note that the following instructions detail how to download and install the 32-bit JDK, although the steps are nearly identical for installing the 64-bit version.
	</p><h5 xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="formalpara">Downloading</h5><p class="formalpara">
			You can download the Sun JDK 5.0 (Java 2 Development Kit) from Sun's website: <a class="ulink" href="http://java.sun.com/javase/downloads/index_jdk5.jsp">http://java.sun.com/javase/downloads/index_jdk5.jsp</a>. Click on the <span class="guilabel"><strong>Download</strong></span> link next to "JDK 5.0 Update <em class="replaceable"><code>&lt;x&gt;</code></em>" (where <em class="replaceable"><code>&lt;x&gt;</code></em> is the latest minor version release number). On the next page, select your language and platform (both architecture—whether 32- or 64-bit—and operating system), read and agree to the <code class="literal">Java Development Kit 5.0 License Agreement</code>, and proceed to the download page.
		</p><p>
		The Sun website will present two download alternatives to you: one is an RPM inside a self-extracting file (for example, <code class="filename">jdk-1_5_0_16-linux-i586-rpm.bin</code>), and the other is merely a self-extracting file (e.g. <code class="filename">jdk-1_5_0_16-linux-i586.bin</code>). If you are installing the JDK on Red Hat Enterprise Linux, Fedora, or another RPM-based Linux system, we suggest that you download the self-extracting file containing the RPM package, which will set up and use the SysV service scripts in addition to installing the JDK. We also suggest installing the self-extracting RPM file if you will be running <span class="application"><strong>Mobicents</strong></span> in a production environment.
	</p><h5 xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="formalpara">Installing</h5><p class="formalpara">
			The following procedures detail how to install the Java Development Kit on both Linux and Windows.
		</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="procedure"><a id="d0e1981"/><p class="title"><b>Procedure 2.11. Installing the JDK on Linux</b></p><ul><li><p>
				Regardless of which file you downloaded, you can install it on Linux by simply making sure the file is executable and then running it:
			</p><pre class="screen">~]$ chmod +x "jdk-1_5_0_&lt;minor_version&gt;-linux-&lt;architecture&gt;-rpm.bin"
~]$ ./"jdk-1_5_0_&lt;minor_version&gt;-linux-&lt;architecture&gt;-rpm.bin"</pre></li></ul></div><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>You Installed Using the Non-RPM Installer, but Want the SysV Service Scripts</h2><p>
			If you download the non-RPM self-extracting file (and installed it), and you are running on an RPM-based system, you can still set up the SysV service scripts by downloading and installing one of the <code class="literal">-compat</code> packages from the JPackage project. Remember to download the <code class="literal">-compat</code> package which corresponds correctly to the minor release number of the JDK you installed. The compat packages are available from <a class="ulink" href="ftp://jpackage.hmdc.harvard.edu/JPackage/1.7/generic/RPMS.non-free/">ftp://jpackage.hmdc.harvard.edu/JPackage/1.7/generic/RPMS.non-free/</a>.
		</p></div><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="important"><h2>Important</h2><p>
			You do not need to install a <code class="literal">-compat</code> package in addition to the JDK if you installed the self-extracting RPM file! The <code class="literal">-compat</code> package merely performs the same SysV service script set up that the RPM version of the JDK installer does.
		</p></div><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="procedure"><a id="d0e2012"/><p class="title"><b>Procedure 2.12. Installing the JDK on Windows</b></p><ul><li><p>
				Using Explorer, simply double-click the downloaded self-extracting installer and follow the instructions to install the JDK.
			</p></li></ul></div><h5 xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="formalpara">Configuring</h5><p class="formalpara">
			Configuring your system for the JDK consists in two tasks: setting the <code class="envar">JAVA_HOME</code> environment variable, and ensuring that the system is using the proper JDK (or JRE) using the <code class="command">alternatives</code> command. Setting <code class="envar">JAVA_HOME</code> usually overrides the values for <code class="command">java</code>, <code class="command">javac</code> and <code class="command">java_sdk_1.5.0</code> in <code class="command">alternatives</code>, but we will set them all just to be safe and consistent.
		</p><div class="variablelist"><dl><dt><span class="term">Setting the <code class="envar">JAVA_HOME</code> Environment Variable on Generic Linux</span></dt><dd><p>
					After installing the JDK, you must ensure that the <code class="envar">JAVA_HOME</code> environment variable exists and points to the location of your JDK installation.
				</p><h5 xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="formalpara">Setting the <code class="envar">JAVA_HOME</code> Environment Variable on Linux</h5><p class="formalpara">
						You can determine whether <code class="envar">JAVA_HOME</code> is set on your system by <code class="command">echo</code>ing it on the command line:
					</p><pre class="screen">~]$ echo $JAVA_HOME</pre><p>
					If <code class="envar">JAVA_HOME</code> is not set already, then you must set its value to the location of the JDK installation on your system. You can do this by adding two lines to your personal <code class="filename">~/.bashrc</code> configuration file. Open <code class="filename">~/.bashrc</code> (or create it if it doesn't exist) and add a line similar to the following one anywhere inside the file:
				</p><pre class="programlisting">export JAVA_HOME="/usr/lib/jvm/jdk1.5.0_&lt;version&gt;"
</pre><p>
					You should also set this environment variable for any other users who will be running <span class="application"><strong>Mobicents</strong></span> (any environment variables <code class="command">export</code>ed from <code class="filename">~/.bashrc</code> files are local to that user).
				</p></dd><dt><span class="term">Setting <code class="envar">java</code>, <code class="envar">javac</code> and <code class="envar">java_sdk_1.5.0</code> Using the <code class="command">alternatives</code> command </span></dt><dd><h5 xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="formalpara">Selecting the Correct System JVM on Linux using <code class="command">alternatives</code>
					</h5><p class="formalpara">
						On systems with the <code class="command">alternatives</code> command, including Red Hat Enterprise Linux and Fedora, you can easily choose which JDK (or JRE) installation you wish to use, as well as which <code class="command">java</code> and <code class="command">javac</code> executables should be run when called.
					</p><p>
					<span class="emphasis"><em>As the root user</em></span>, call <code class="command">/usr/sbin/alternatives</code> with the <code class="option">--config java</code> option to select between JDKs and JREs installed on your system:
				</p><pre class="programlisting">root@localhost ~]$ /usr/sbin/alternatives --config java

There are 3 programs which provide 'java'.

  Selection    Command
-----------------------------------------------
   1           /usr/lib/jvm/jre-1.5.0-gcj/bin/java
   2           /usr/lib/jvm/jre-1.6.0-sun/bin/java
*+ 3         /usr/lib/jvm/jre-1.5.0-sun/bin/java


Enter to keep the current selection[+], or type selection number:
</pre><p>
					In our case, we want to use the Sun JDK, version 5, that we downloaded and installed, to run the <code class="command">java</code> executable. In the <code class="command">alternatives</code> information printout above, a plus (<code class="literal">+</code>) next to a number indicates the one currently being used. As per <code class="command">alternatives</code>' instructions, pressing <span class="keycap"><strong>Enter</strong></span> will simply keep the current JVM, or you can enter the number corresponding to the JVM you would prefer to use.
				</p><p>
					Repeat the procedure above for the <code class="command">javac</code> command and the <code class="literal">java_sdk_1.5.0</code> environment variable, <span class="emphasis"><em>as the root user</em></span>:
				</p><pre class="screen">~]$ /usr/sbin/alternatives --config javac</pre><pre class="screen">~]$ /usr/sbin/alternatives --config java_sdk_1.5.0</pre></dd><dt><span class="term">Setting the <code class="envar">JAVA_HOME</code> Environment Variable on Windows</span></dt><dd><p>
					For information on how to set environment variables in Windows, refer to <a class="ulink" href="http://support.microsoft.com/kb/931715">http://support.microsoft.com/kb/931715</a>.
				</p></dd></dl></div><h5 xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="formalpara">Testing</h5><p class="formalpara">
			Finally, to make sure that you are using the correct JDK or Java version (5 or higher), and that the java executable is in your <code class="envar">PATH</code>, run the <code class="command">java <code class="option">-version</code>
			</code> command in the terminal from your home directory:
		</p><pre class="screen">~]$ java -version
java version "1.5.0_16"
Java(TM) 2 Runtime Environment, Standard Edition (build 1.5.0_16-b03)
Java HotSpot(TM) Client VM (build 1.5.0_16-b03, mixed mode, sharing)</pre><h5 xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="formalpara">Uninstalling</h5><p class="formalpara">
			There is usually no reason (other than space concerns) to remove a particular JDK from your system, given that you can switch between JDKs and JREs easily using <code class="command">alternatives</code>, and/or by setting <code class="envar">JAVA_HOME</code>.
		</p><h5 xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="formalpara">Uninstalling the JDK on Linux</h5><p class="formalpara">
			On RPM-based systems, you can uninstall the JDK using the <code class="command">yum <code class="option">remove &lt;jdk_rpm_name&gt;</code>
			</code> command.
		</p><h5 xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="formalpara">Uninstalling the JDK on Windows</h5><p class="formalpara">
			On Windows systems, check the JDK entry in the <code class="literal">Start</code> menu for an uninstall command, or use <code class="literal">Add/Remove Programs</code>.
		</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="bssswticar-binary-SIP_Servlets_Server_with_Tomcat-PreInstall_Requirements_and_Prerequisites"/>2.2.2. Pre-Install Requirements and Prerequisites</h3></div></div></div><div class="variablelist"><a id="bssswticar-binary-SIP_Servlets_Server_with_Tomcat-Hardware_Requirements"/><p class="title"><b>Hardware Requirements</b></p><dl><dt><span class="term">Sufficient Disk Space</span></dt><dd><p>You must have sufficient disk space in order to install the MSS for Tomcat binary release. Once unzipped, version 1.4.0.FINAL of the MSS for Tomcat binary release requires <span class="emphasis"><em>at least</em></span> 20MB of free disk space. Keep in mind that disk space requirements may change from release to release.</p></dd><dt><span class="term">Anything Java Itself Will Run On</span></dt><dd><p>MSS for Tomcat is 100% Java. It will run on the same hardware that the Tomcat Servlet Container runs on.</p></dd></dl></div><div class="variablelist"><a id="bssswticar-binary-SIP_Servlets_Server_with_Tomcat-Software_Prerequisites"/><p class="title"><b>Software Prerequisites</b></p><dl><dt><span class="term">JDK 5 or Higher</span></dt><dd><p>A working installation of the Java Development Kit (<acronym class="acronym">JDK</acronym>) version 5 or higher is required in order to run MSS for Tomcat.</p></dd></dl></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="bssswticar-binary-SIP_Servlets_Server_with_Tomcat-Downloading"/>2.2.3. Downloading</h3></div></div></div><p>You can download the latest version of MSS for Tomcat from <a class="ulink" href="http://www.mobicents.org/mss-downloads.html">http://www.mobicents.org/mss-downloads.html</a>. The top row of the table holds the latest version. Note that each release of the Mobicents SIP Servlets Server is comprised of two separate binary distribution files: one which is MSS for JBoss, and the other which is MSS for Tomcat. Download Mobicents SIP Servlets Server for Tomcat and continue with the following instructions.</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="bssswticar-binary-SIP_Servlets_Server_with_Tomcat-Installing"/>2.2.4. Installing</h3></div></div></div><p>Once the requirements and prerequisites have been met and you have downloaded the binary distribution zip file, you are ready to install MSS for Tomcat. Follow the instructions below for your platform, whether Linux or Windows.</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><a id="bssswticar-binary-SIP_Servlets_Server_with_Tomcat-Use_Version_Numbers_Relevant_to_Your_Installation"/><h2>Use Version Numbers Relevant to Your Installation!</h2><p>For clarity, the command line instructions presented in this chapter use specific version numbers and directory names. Remember to replace them with version numbers and file names relevant to those you are actually working with.</p></div><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="procedure"><a id="d0e2292"/><p class="title"><b>Procedure 2.13. Installing the MSS for Tomcat Binary Distribution on Linux</b></p><ol class="1"><li><p>For this example, we'll assume you're currently in your home directory, which is where you downloaded the zip file to. First, create a subdirectory to hold the unzipped MSS for Tomcat files. It is good practice to include the version number in this directory name; if you do so, remember to correctly match it with the version of the MSS for Tomcat distribution you downloaded.</p><pre class="screen">~]$ cd downloads</pre></li><li><p>In <code class="filename">downloads</code>, create a subdirectory to hold the unzipped MSS for Tomcat files. It is good practice to include the version number in this directory name; if you do so, remember to correctly match it with the version of the MSS for Tomcat binary distribution you downloaded.</p><pre class="screen">~]$ mkdir "mss-tomcat-&lt;version&gt;"</pre></li><li><p>Move the downloaded zip file into the directory you have just created:</p><pre class="screen">~]$ mv "mss-1.3.1-apache-tomcat-6.0.20-1007051527.zip" "mss-tomcat-&lt;version&gt;"</pre></li><li><p>Move into that directory:</p><pre class="screen">~]$ cd "mss-tomcat-&lt;version&gt;"</pre></li><li><p>Finally, use Java's <code class="command">jar <code class="option">-xvf</code></code> command to extract the contents of the zip file into the current directory, thus completing the install:</p><pre class="screen">mss-tomcat-&lt;version&gt;]$ jar -xvf "mss-1.3.1-apache-tomcat-6.0.20-1007051527.zip"</pre><ul>
          <li><p>Alternatively, if Linux's <code class="command">unzip</code> utility is present on your system or is installable, you can use it in lieu of Java's <code class="command">jar <code class="option">-xvf</code></code> command:</p><pre class="screen">mss-tomcat-&lt;version&gt;]$ unzip "mss-1.3.1-apache-tomcat-6.0.20-1007051527.zip"</pre><div class="note"><h2>Note</h2><p>You can also use <code class="command">unzip</code>'s <code class="option">-d</code>
        <code class="filename">
                  <em class="replaceable"><code>&lt;unzip_to_location&gt;</code></em>
                </code> option to extract the zip file's contents to a location other than the current directory.</p></div></li>
        </ul></li><li><p>To free disk space, you may want to delete the zip file once you've extracted its contents:</p><pre class="screen">mss-tomcat-&lt;version&gt;]$ rm "mss-1.3.1-apache-tomcat-6.0.20-1007051527.zip"</pre></li></ol></div><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="procedure"><a id="d0e2364"/><p class="title"><b>Procedure 2.14. Installing the MSS for Tomcat Binary Distribution on Windows</b></p><ol class="1"><li><p>For this example, we'll assume that you downloaded the binary distribution zip file to the <code class="filename">My Downloads</code> folder. First, using Windows Explorer, create a subdirectory in <code class="filename">My Downloads</code> to extract the zip file's contents into. When you name this folder, it is good practice to include the version number; if you do so, remember to correctly match it with the version of the MSS for Tomcat binary distribution you downloaded. In these instructions, we will refer to this folder as <code class="filename">mss-tomcat-<em class="replaceable"><code>&lt;version&gt;</code></em></code>.</p></li><li><p>Double-click the downloaded zip file, selecting as the destination folder the one you just created to hold the zip file's contents.</p><ul>
          <li><p>Alternatively, it is also possible to use Java's <code class="command">jar <code class="option">-xvf</code></code> command to extract the binary distribution files from the zip archive. To use this method instead, first move the downloaded zip file from <code class="filename">My Downloads</code> to the folder that you just created to hold the SIP Servlets Server files.</p></li>
          <li><p>Then, open the Windows Command Prompt and navigate to the folder holding the archive using the <code class="command">cd</code> command.</p><div class="note"><a id="bssswticar-binary-SIP_Servlets_Server_with_Tomcat-Opening_the_Command_Prompt_from_Windows_Explorer"/><h2>Opening the Command Prompt from Windows Explorer</h2><p>If you are using Windows Vista®, you can open the Command Prompt directly from Explorer. Hold down the <span class="keycap"><strong>Shift</strong></span> key and right-click on either a folder, the desktop, or inside a folder. This will cause an <span class="guimenuitem"><strong>Open Command Window Here</strong></span> context menu item to appear, which can be used to open the Command Prompt with the current working directory set to either the folder you opened, or opened it from.</p></div></li>
          <li><p>Finally, use the <code class="command">jar <code class="option">-xvf</code></code> command to extract the archive contents into the current folder.</p><pre class="screen">C:\Users\Me\My Downloads\mss-tomcat-&lt;version&gt;&gt;jar -xvf "mss-1.3.1-apache-tomcat-6.0.20-1007051527.zip"</pre></li>
        </ul></li><li><p>At this point, you may want to move the folder holding the MSS for Tomcat binary files (in this example, the folder named <code class="filename">mss-tomcat-<em class="replaceable"><code>&lt;version&gt;</code></em></code>) to another location. This step is not strictly necessary, but it is probably a good idea to move the installation folder from <code class="filename">My Downloads</code> to a user-defined location for storing runnable programs. Any location will suffice, however.</p></li><li><p>You may want to delete the zip file after extracting its contents in order to free disk space:</p><pre class="screen">C:\Users\Me\My Downloads\mss-tomcat-&lt;version&gt;&gt;delete "mss-1.3.1-apache-tomcat-6.0.20-1007051527.zip"</pre></li></ol></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="section-SIP_Servlets_Server_with_Tomcat-Setting_the_CATALINA_HOME_Environment_Variable"/>2.2.5. Setting the CATALINA_HOME Environment Variable</h3></div></div></div><p>Before running the Mobicents server you are installing, you should consider if you need to set the <code class="envar">CATALINA_HOME</code> environment variable. Setting it (or re-setting it) will always work. Whether or not you <span class="emphasis"><em>need</em></span> to set <code class="envar">CATALINA_HOME</code> depends on the following factors:</p><div class="itemizedlist"><ul><li><p>If you are installing a binary Mobicents server and <code class="envar">CATALINA_HOME</code> is not set on your system, then you <span class="emphasis"><em>do not need</em></span> to set it, but doing so will do no harm.</p></li><li><p>If you are installing a binary Mobicents server and <code class="envar">CATALINA_HOME</code> is (already) set on your system, then you need to make sure it points to the location of the new Mobicents server.</p></li><li><p>If you are installing a Mobicents server from source which uses the Tomcat servlet container, then you <span class="emphasis"><em>must</em></span> set <code class="envar">CATALINA_HOME</code>.</p></li></ul></div><p>The following instructions detail how to set <code class="envar">CATALINA_HOME</code> on both Linux and Windows.</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="procedure"><a id="bssswticar-Setting_the_CATALINA_HOME_Environment_Variable_on_Linux"/><p class="title"><b>Procedure 2.15. Setting the <code class="envar">CATALINA_HOME</code> Environment Variable on Linux</b></p><ol class="1"><li><p>The <code class="envar">CATALINA_HOME</code> environment variable must point to the location of your Tomcat installation. Any Mobicents server which runs on top of the Tomcat servlet container has a topmost directory, i.e. the directory in which you unzipped the zip file to install the server, and underneath that directory, a <code class="filename">bin</code> directory. <code class="envar">CATALINA_HOME</code> must be set to the topmost directory of your Mobicents server installation.</p><p>Setting this variable in your personal <code class="filename">~/.bashrc</code> file has the advantage that it will always be set (for you, as a user) each time you log in or reboot the system. To do so, open <code class="filename">~/.bashrc</code> in a text editor (or create the file if it doesn't already exist) and insert the following line anywhere in the file, taking care to substitute <code class="filename">&lt;mobicents_server&gt;</code> for the topmost directory of the Mobicents server you installed:</p><pre class="screen">export CATALINA_HOME="/home/&lt;username&gt;/&lt;path&gt;/&lt;to&gt;/&lt;mobicents_server&gt;"</pre><p>Save and close <code class="filename">.bashrc</code>.</p></li><li><p>You can—and should—<code class="command">source</code> your <code class="filename">.bashrc</code> file to make your change take effect (so that <code class="envar">CATALINA_HOME</code> is set) for the current session:</p><pre class="screen">~]$ source ~/.bashrc</pre></li><li><p>Finally, make sure that <code class="envar">CATALINA_HOME</code> has been set correctly (that it leads to the right directory), and has taken effect in the current session.</p><p>The following command will show the path to the directory pointed to by <code class="envar">CATALINA_HOME</code>:</p><pre class="screen">~]$ echo $CATALINA_HOME</pre><p>To be absolutely sure, change your directory to the one pointed to by <code class="envar">CATALINA_HOME</code>:</p><pre class="screen">~]$ cd $CATALINA_HOME &amp;&amp; pwd</pre></li></ol></div><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="procedure"><a id="bssswticar-Setting_the_CATALINA_HOME_Environment_Variable_on_Windows"/><p class="title"><b>Procedure 2.16. Setting the <code class="envar">CATALINA_HOME</code> Environment Variable on Windows</b></p><ul><li><p>The <code class="envar">CATALINA_HOME</code> environment variable must point to the location of your Tomcat installation. Any Mobicents server which runs on top of the Tomcat servlet container has a topmost directory, i.e. the directory in which you unzipped the zip file to install the server, and underneath that directory, a <code class="filename">bin</code> directory. <code class="envar">CATALINA_HOME</code> must be set to the topmost directory of your Mobicents server installation.</p><p>If you are planning on running the Tomcat container as the Administrator, then you should, of course, set the <code class="envar">CATALINA_HOME</code> environment variable <span class="emphasis"><em>as the administrator</em></span>, and if you planning to run Tomcat as a normal user, then set <code class="envar">CATALINA_HOME</code> as a user environment variable.</p><p>For information on how to set environment variables in Windows, refer to <a class="ulink" href="http://support.microsoft.com/kb/931715">http://support.microsoft.com/kb/931715</a>.</p></li></ul></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="bssswticar-binary-SIP_Servlets_Server_with_Tomcat-Configuring"/>2.2.6. Configuring</h3></div></div></div><p>Configuring MSS for Tomcat consists in setting the <code class="envar">CATALINA_HOME</code> environment variable and then, optionally, customizing your MSS for Tomcat container by adding SIP Connectors, configuring the application router, and configuring logging. See <a class="xref" href="sssicar-SIP_Servlets_Server-Installing_Configuring_and_Running.html#bsssc-binary-SIP_Servlets_Server-Configuring" title="2.3. Configuring">Section 2.3, “Configuring”</a> to learn what and how to configure MSS for Tomcat.</p><p>Alternatively, you can simply run your MSS for Tomcat container now and return to this section to configure it later.</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="bssswticar-binary-SIP_Servlets_Server_with_Tomcat-Running"/>2.2.7. Running</h3></div></div></div><p>Once installed, you can run the Tomcat Servlet Container by executing the one of the startup scripts in the <code class="filename">bin</code> directory (on Linux or Windows), or by double-clicking the <code class="filename">run.bat</code> executable batch file in that same directory (on Windows only). However, we suggest always starting Tomcat using the terminal or Command Prompt because you are then able to read—and act upon—any startup messages, and possibly debug any problems that may arise. In the Linux terminal or Command Prompt, you will be able to tell that the container started successfully if the last line of output is similar to the following:</p><pre class="programlisting">Using CATALINA_BASE:   /home/silas/temp/apps/mobicents/sip_servlets_server/mss-tomcat-1.0
Using CATALINA_HOME:   /home/silas/temp/apps/mobicents/sip_servlets_server/mss-tomcat-1.0
Using CATALINA_TMPDIR: /home/silas/temp/apps/mobicents/sip_servlets_server/mss-tomcat-1.0/temp
Using JRE_HOME:       /etc/java-config-2/current-system-vm</pre><p>Detailed instructions are given below, arranged by platform.</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="procedure"><a id="d0e2617"/><p class="title"><b>Procedure 2.17. Running MSS for Tomcat on Linux</b></p><ol class="1"><li><p>Change your working directory to the SIP Servlets-customized Tomcat's topmost directory (the one in which you extracted the zip file's contents to):</p><pre class="screen">~]$ cd "mss-tomcat-&lt;version&gt;"</pre></li><li><p>(Optional) Ensure that the <code class="filename">bin/startup.sh</code> start script is executable:</p><pre class="screen">mss-tomcat-&lt;version&gt;]$ chmod +x bin/startup.sh</pre></li><li><p>Finally, execute the <code class="filename">startup.sh</code> Bourne shell script:</p><pre class="screen">mss-tomcat-&lt;version&gt;]$ ./bin/startup.sh</pre></li></ol></div><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="procedure"><a id="d0e2641"/><p class="title"><b>Procedure 2.18. Running MSS for Tomcat on Windows</b></p><ol class="1"><li><p>There are several different ways to start the Tomcat Servlet Container on Windows. All of the following methods accomplish the same task.</p><p>Using Windows Explorer, change your folder to the one in which you unzipped the downloaded zip file, and then to the <code class="filename">bin</code> subdirectory.</p></li><li><p>Although not the preferred way (see below), it is possible to start the Tomcat Servlet Container by double-clicking on the <code class="filename">startup.bat</code> executable batch file.</p><ul>
          <li><p>As mentioned above, the best way to start the Tomcat Servlet Container is by using the Command Prompt. Doing it this way will allow you to view all of the server startup details, which will enable you to easily determine whether any problems were encountered during the startup process. You can open the Command Prompt directly from the <code class="filename">&lt;topmost_directory&gt;\bin</code> folder in Windows Explorer, or you can open the Command Prompt via the <span class="guilabel"><strong>Start</strong></span> menu and navigate to the correct folder:</p><pre class="screen">C:\Users\Me\My Downloads&gt; cd "mss-tomcat-&lt;version&gt;"</pre></li>
          <li><p>Start the Tomcat Servlet Container by running the executable <code class="filename">startup.bat</code> batch file:</p><pre class="screen">C:\Users\Me\My Downloads\mss-tomcat-&lt;version&gt;&gt;bin\startup.bat</pre></li>
        </ul></li></ol></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="bssswticar-binary-SIP_Servlets_Server_with_Tomcat-Stopping"/>2.2.8. Stopping</h3></div></div></div><p>Detailed instructions for stopping the Tomcat Servlet Container are given below, arranged by platform. Note that if you properly stop the server, you will see the following three lines as the last output in the Linux terminal or Command Prompt (both running and stopping the Tomcat Servlet Container produces the same output):</p><pre class="screen">Using CATALINA_BASE:   /home/silas/temp/apps/mobicents/sip_servlets_server/mss-tomcat-1.0
Using CATALINA_HOME:   /home/silas/temp/apps/mobicents/sip_servlets_server/mss-tomcat-1.0
Using CATALINA_TMPDIR: /home/silas/temp/apps/mobicents/sip_servlets_server/mss-tomcat-1.0/temp
Using JRE_HOME:       /etc/java-config-2/current-system-vm</pre><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="procedure"><a id="d0e2690"/><p class="title"><b>Procedure 2.19. Stopping MSS for Tomcat on Linux by Executing <code class="filename">shutdown.sh</code></b></p><ol class="1"><li><p>You can shut down the Tomcat Servlet Container by executing the <code class="filename">shutdown.sh</code> Bourne shell script in the <code class="filename">&lt;topmost_directory&gt;/bin</code> directory. To do so, first change your working directory to the binary distribution's topmost directory (the one to which you extracted the downloaded zip file's contents):</p><pre class="screen">downloads]$ cd "mss-tomcat-&lt;version&gt;"</pre></li><li><p>(Optional) Ensure that the bin/shutdown.sh start script is executable:</p><pre class="screen">mss-tomcat-&lt;version&gt;]$ chmod +x bin/shutdown.sh</pre></li><li><p>Finally, run the <code class="filename">shutdown.sh</code> executable Bourne shell script</p><pre class="screen">mss-tomcat-&lt;version&gt;]$ ./bin/shutdown.sh</pre></li></ol></div><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="procedure"><a id="d0e2719"/><p class="title"><b>Procedure 2.20. Stopping MSS for Tomcat on Windows</b></p><ul><li><p>Stopping the Tomcat Servlet Container on Windows consists in executing the <code class="filename">shutdown.bat</code> executable batch script in the <code class="filename">bin</code> subdirectory of the SIP Servlets-customized Tomcat binary distribution:</p><pre class="screen">C:\Users\Me\My Downloads\mss-tomcat-&lt;version&gt;&gt;bin\shutdown.bat</pre></li></ul></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="bssswticar-binary-SIP_Servlets_Server-Using"/>2.2.9. Using</h3></div></div></div><p>After starting the server successfully, you can access the default web applications included with MSS for Tomcat by opening the following URL in your browser: <a class="ulink" href="http://localhost:8080/">http://localhost:8080/</a>.</p><p>You can also access the SIP Servlets Management Console by opening <a class="ulink" href="http://localhost:8080/sip-servlets-management/">http://localhost:8080/sip-servlets-management/</a> in your browser.</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="bssswticar-binary-SIP_Servlets_Server_with_Tomcat-Testing"/>2.2.10. Testing</h3></div></div></div><p/></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="bssswticar-binary-SIP_Servlets_Server_with_Tomcat-Uninstalling"/>2.2.11. Uninstalling</h3></div></div></div><p>To uninstall MSS for Tomcat, simply delete the directory you decompressed the binary distribution archive into.</p></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="bsssc-binary-SIP_Servlets_Server-Configuring"/>2.3. Configuring</h2></div></div></div><p/><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="bsssc-binary-SIP_Servlets_Server-Adding_SIP_Connectors"/>2.3.1. Configuring SIP Connectors</h3></div></div></div><p>SIP Connectors are added in the same way as HTTP Connectors: by adding a <code class="literal">&lt;Connector&gt;</code> element under the <code class="literal">&lt;Service&gt;</code> element in the container's <code class="filename">server.xml</code> configuration file.</p><p>Mobicents SIP Servlets has three SIP Connectors configured by default : UDP And TCP are running on the binding IP Address of the container and port 5080 and TLS is running on the binding IP Address of the container and port 5081</p><p>For example, to add a SIP Connector on the IP address <code class="literal">127.0.0.1</code>, on port <code class="literal">5080</code>, using the UDP transport protocol, you should insert the following XML element:</p><div class="example"><a id="d0e2782"/><p class="title"><b>Example 2.1. Adding a SIP Connector to server.xml</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">Connector</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">port</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;5080&quot;</span><span class="xml_plain">&nbsp;</span><br />
<span class="xml_attribute_name">ipAddress</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;127.0.0.1&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">protocol</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;org.mobicents.servlet.sip.startup.SipProtocolHandler&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">signalingTransport</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;udp&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">useStun</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;false&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">stunServerAddress</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;stun01.sipphone.com&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">stunServerPort</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;3478&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">staticServerAddress</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;122.122.122.122&quot;</span><span class="xml_plain">&nbsp;</span><br />
<span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">staticServerPort</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;44&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">useStaticAddress</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;true&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">httpFollowsSip</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;false&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
</pre></div></div><br class="example-break"/><div class="variablelist"><p class="title"><b>SIP &lt;connector&gt; Attributes</b></p><dl><dt><span class="term">port</span></dt><dd><p>The port number on which the container will be able to receive SIP messages.</p></dd><dt><span class="term">ipAddress</span></dt><dd><p>The IP address at which the container will be able to receive SIP messages.  The container can be configured to listen to all available IP addresses by setting <em class="parameter"><code>ipAddress</code></em> to <strong class="userinput"><code>0.0.0.0 &lt;sipPathName&gt;</code></strong>.</p></dd><dt><span class="term">protocol</span></dt><dd><p>Specifies the connector is a SIP Connector and not an HTTP Connector.  There is no need to change this property.</p></dd><dt><span class="term">signalingTransport</span></dt><dd><p>Specifies the transport on which the container will be able to receive SIP messages.  For example, "udp".</p></dd><dt><span class="term">useStun</span></dt><dd><p>Enables Session Traversal Utilities for NAT (STUN) support for this Connector.  The attribute defaults to "false".  If set to "true", ensure that the <code class="literal">ipAddress</code> attribute is <span class="emphasis"><em>not</em></span> set to <code class="literal">127.0.0.1</code>.  Refer to <a class="xref" href="afotsss-Advanced_Features_of_the_SIP_Servlets_Server.html#mssstun-MSS_STUN" title="7.4. STUN Support">Section 7.4, “STUN Support”</a> for more information about STUN.</p></dd><dt><span class="term">stunServerAddress</span></dt><dd><p>Specifies the STUN server address used to discover the public IP address of the SIP Connector.  This attribute is only required if the <code class="literal">useStun</code> attribute is set to "true". Refer to <a class="xref" href="afotsss-Advanced_Features_of_the_SIP_Servlets_Server.html#mssstun-MSS_STUN" title="7.4. STUN Support">Section 7.4, “STUN Support”</a> for more information about STUN and public STUN servers.</p></dd><dt><span class="term">stunServerPort</span></dt><dd><p>Specifies the STUN server port of the STUN server used in the <code class="literal">stunServerAddress</code> attribute. You should rarely need to change this attribute; also, it is only needed if the <code class="literal">useStun</code> attribute is set to "true". Refer to <a class="xref" href="afotsss-Advanced_Features_of_the_SIP_Servlets_Server.html#mssstun-MSS_STUN" title="7.4. STUN Support">Section 7.4, “STUN Support”</a> for more information about STUN.</p></dd><dt><span class="term">addressResolverClass</span></dt><dd><p>Specifies the <code class="literal">gov.nist.core.net.AddressResolver</code> implementation class that will be used by the container to perform DNS lookups. The default class used by the container is <code class="literal">org.mobicents.servlet.sip.core.DNSAddressResolver</code> but any class implementing <code class="literal">gov.nist.core.net.AddressResolver</code> NIST SIP Stack interface and having a Constructor with a <code class="literal">org.mobicents.servlet.sip.core.SipApplicationDispatcher</code> param can be used. To disable DNS lookups, this attribute should be left empty..</p></dd><dt><span class="term">useStaticAddress</span></dt><dd><p>Specifies  whether the settings in staticServerAddress and staticServerPort are activated.  The default value is "false" (deactivated).</p></dd><dt><span class="term">staticServerAddress</span></dt><dd><p>Specifies what load-balancer server address is inserted in Contact/Via headers for server-created requests. This parameter  is useful for  cluster configurations where  requests should  be bound to a load-balancer address, rather than  a specific node address.</p></dd><dt><span class="term">staticServerPort</span></dt><dd><p>Specifies the port of the load-balancer specified in staticServerAddress . This parameter is useful in cluster configurations where requests should be bound to a load-balancer address rather than a specific node address.</p></dd><dt><span class="term">httpFollowsSip</span></dt><dd><p>This flag makes the application server aware of how the SIP load balancers assign request affinity and stores this information in the application session. When HTTP load balancer sends HTTP request not associated with this application session the application server will force this HTTP request to be repeated to land on the correct node.</p></dd></dl></div><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>Note</h2><p>A comprehensive list of implementing classes for the SIP Stack is available from the <a class="ulink" href="http://hudson.jboss.org/hudson/job/jain-sip/lastSuccessfulBuild/artifact/javadoc/javax/sip/SipStack.html">Class SipStackImpl page on nist.gov</a>.</p></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="bsssc-binary-SIP_Servlets_Server-Configuring_Application_Routing"/>2.3.2. Application Routing and Service Configuration</h3></div></div></div><p>The application router is called by the container—whether JBoss or Tomcat—to select a SIP Servlet application to service an initial request. It embodies the logic used to choose which applications to invoke. An application router is required for a container to function, but it is a separate logical entity from the container. The application router is solely responsible for application selection and must not implement application logic. For example, the application router cannot modify a request or send a response.</p><p>For more information about the application router, refer to the following sections of the JSR 289 specification: Application Router Packaging and Deployment, Application Selection Process, and Appendix C.
   </p><p>In order to configure the application router, you should edit the <code class="literal">Service</code> element in the container's <code class="filename">server.xml</code> configuration file:</p><div class="example"><a id="bsssc-Configuring_the_Service_Element_in_the_Containers_server.xml"/><p class="title"><b>Example 2.2. Configuring the Service Element in the Container's server.xml</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">Service</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;Sip-Servlets&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">className</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;org.mobicents.servlet.sip.startup.SipStandardService&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">sipApplicationDispatcherClassName</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;org.mobicents.servlet.sip.core.SipApplicationDispatcherImpl&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">usePrettyEncoding</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;false&quot;</span><span class="xml_plain">&nbsp;</span><br />
<span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">additionalParameterableHeaders</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;Header1,Header2&quot;</span><span class="xml_plain">&nbsp;</span><br />
<span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">bypassResponseExecutor</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;false&quot;</span><span class="xml_plain">&nbsp;</span><br />
<span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">bypassRequestExecutor</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;false&quot;</span><span class="xml_plain">&nbsp;</span><br />
<span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">baseTimerInterval</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;500&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">t2Interval</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;4000&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">t4Interval</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;5000&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">timerDInterval</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;32000&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">dispatcherThreadPoolSize</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;4&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">darConfigurationFileLocation</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;file:///home/silas/workspaces/mobicents-sip-servlets/</span><br />
<span class="xml_attribute_value">&nbsp;sip-servlets-examples/reinvite-demo/reinvite-dar.properties&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">sipStackPropertiesFile</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;conf/mss-sip-stack.properties&quot;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">dialogPendingRequestChecking</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;false&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;</span><br />
</pre></div></div><br class="example-break"/><p>Provided here is a description of the SIP Service element's attributes:</p><div class="variablelist"><dl><dt><span class="term">className</span></dt><dd><p>This attribute specifies that the servlet container is a <span class="emphasis"><em>converged</em></span> (i.e. SIP + HTTP) servlet container.</p></dd><dt><span class="term">sipApplicationDispatcherClassName</span></dt><dd><p>This attribute specifies the class name of the <code class="literal">org.mobicents.servlet.sip.core.SipApplicationDispatcher</code> implementation to use. The routing algorithm and application selection process is performed in that class.</p></dd><dt><span class="term">darConfigurationFileLocation</span></dt><dd><p>The default application router file location. This is used by the default application router to determine the application selection logic. Refer to Appendix C of the JSR 289 specification for more details.</p></dd><dt><span class="term">sipStackPropertiesFile</span></dt><dd><p>Specifies the location of the file containing key-value pairs corresponding to the SIP stack configuration properties.  This attribute is used to further tune the JAIN SIP Stack.  If this property is omitted, the following default values are assumed:</p><div class="itemizedlist"><ul><li><p>gov.nist.javax.sip.LOG_MESSAGE_CONTENT=true</p></li><li><p>gov.nist.javax.sip.TRACE_LEVEL=32</p></li><li><p>gov.nist.javax.sip.DEBUG_LOG=logs/mss-jsip-debuglog.txt</p></li><li><p>gov.nist.javax.sip.SERVER_LOG=logs/mss-jsip-messages.xml</p></li><li><p>javax.sip.STACK_NAME=Mobicents-SIP-Servlets</p></li><li><p>javax.sip.AUTOMATIC_DIALOG_SUPPORT=off</p></li><li><p>gov.nist.javax.sip.DELIVER_UNSOLICITED_NOTIFY=true</p></li><li><p>gov.nist.javax.sip.THREAD_POOL_SIZE=64</p></li><li><p>gov.nist.javax.sip.REENTRANT_LISTENER=true</p></li><li><p>gov.nist.javax.sip.MAX_FORK_TIME_SECONDS=0. Dialog forking is not enabled by default as it has an impact on memory. If set to a value greater than 0, Dialog Forking will be enabled on Mobicents Sip Servlets.</p></li><li><p>gov.nist.javax.sip.AUTOMATIC_DIALOG_ERROR_HANDLING=false. Merged requests Loop Detection is turned off by default</p></li></ul></div><p>Mobicents SIP Servlets also adds its own properties to allow for even more configuration and flexibility :</p><div class="itemizedlist"><ul><li><p>If the property <code class="literal">org.mobicents.servlet.sip.SERVER_HEADER</code> is set, A Server header will be added to all SIP Responses leaving the container.</p></li><li><p>If the property <code class="literal">org.mobicents.servlet.sip.USER_AGENT_HEADER</code> is set, A Server header will be added to all SIP Requests leaving the container.</p></li></ul></div></dd><dt><span class="term">usePrettyEncoding</span></dt><dd><p>Allows Via, Route, and RecordRoute header field information to be split into multiple lines, rather than each header field being separating with a comma.  The attribute defaults to "true".  Leaving this attribute at the default setting may assist in debugging non-RFC3261 compliant SIP servers.</p></dd><dt><span class="term">additionalParameterableHeaders</span></dt><dd><p>Comma-separated list of header names that are treated as Parameterable by the container.  The specified headers are classed as valid, in addition to the standard Parameterable headers defined in the Sip Servlets 1.1 Specification. </p><p>Setting and getting parameters is allowed for the standard, and additional parameters.  Parameters that are not specified in <code class="literal">additionalParameterableHeaders</code> will result in a ServletParseException error.</p></dd><dt><span class="term">bypassRequestExecutor/bypassResponseExecutor</span></dt><dd><p>If set to false, the SIP Servlets server uses a ThreadPoolExecutor linked to a LinkedBlockingQueue to dispatch the request/response threads. The container can thus handles two different responses (for example a 180 Ringing and a 200 OK) concurrently, but a race condition can occur where the second response overtakes the first one (200 OK dispatched to the application before the 180 Ringing) on UDP.</p><p>So those flags are true by default thus using jain sip serializing per transaction to ensure such race conditions don't occur in Mobicents Sip Servlets even though they can still happen on UDP at jain sip level. </p></dd><dt><span class="term">baseTimerInterval</span></dt><dd><p>Specifies the <code class="literal">T1</code> Base Timer Interval, which allows the SIP Servlets Container to adjust its timers depending on network conditions.  The default interval is 500 (milliseconds).</p><p>For more information about  available timers, refer to  <a class="ulink" href="http://tools.ietf.org/html/rfc3261#appendix-A">RFC326 "Table of Timer Values"1</a>, and the document contained in the <a class="ulink" href="http://www.3gpp.org/ftp/Specs/html-info/24229.htm">3GPP-IMS TS 24.229 v9.1.0 specification ZIP archive</a>.</p><p>All of the timers present in the tables depend on <code class="literal">T1</code>, <code class="literal">T2</code>, <code class="literal">T4</code>, and <code class="literal">Timer D</code> </p></dd><dt><span class="term">t2Interval</span></dt><dd><p>Specifies the <code class="literal">T2</code> Interval, which allows the SIP Servlets Container to adjust its timers depending on network conditions.  The default interval is 4000 (milliseconds).</p><p>For more information about available timers, refer to  <a class="ulink" href="http://tools.ietf.org/html/rfc3261#appendix-A">RFC326 "Table of Timer Values"1</a>, and the document contained in the <a class="ulink" href="http://www.3gpp.org/ftp/Specs/html-info/24229.htm">3GPP-IMS TS 24.229 v9.1.0 specification ZIP archive</a>.</p><p>All of the timers present in the tables depend on <code class="literal">T1</code>, <code class="literal">T2</code>, <code class="literal">T4</code>, and <code class="literal">Timer D</code> </p></dd><dt><span class="term">t4Interval</span></dt><dd><p>Specifies the <code class="literal">T4</code> Interval, which allows the SIP Servlets Container to adjust its timers depending on network conditions.  The default interval is 5000 (milliseconds).</p><p>For more information about available timers, refer to  <a class="ulink" href="http://tools.ietf.org/html/rfc3261#appendix-A">RFC326 "Table of Timer Values"1</a>, and the document contained in the <a class="ulink" href="http://www.3gpp.org/ftp/Specs/html-info/24229.htm">3GPP-IMS TS 24.229 v9.1.0 specification ZIP archive</a>.</p><p>All of the timers present in the tables depend on <code class="literal">T1</code>, <code class="literal">T2</code>, <code class="literal">T4</code>, and <code class="literal">Timer D</code> </p></dd><dt><span class="term">timerDInterval</span></dt><dd><p>Specifies the <code class="literal">Timer D</code> Interval, which allows the SIP Servlets Container to adjust its timers depending on network conditions.  The default interval is 32000 (milliseconds).</p><p>For more information about available timers, refer to  <a class="ulink" href="http://tools.ietf.org/html/rfc3261#appendix-A">RFC326 "Table of Timer Values"1</a>, and the document contained in the <a class="ulink" href="http://www.3gpp.org/ftp/Specs/html-info/24229.htm">3GPP-IMS TS 24.229 v9.1.0 specification ZIP archive</a>.</p><p>All of the timers present in the tables depend on <code class="literal">T1</code>, <code class="literal">T2</code>, <code class="literal">T4</code>, and <code class="literal">Timer D</code> </p></dd><dt><span class="term">dispatcherThreadPoolSize</span></dt><dd><p>The number of threads used for processing  SIP messages inside the Sip Servlets container by the dispatcher. The default value is 4.</p></dd><dt><span class="term">dialogPendingRequestChecking</span></dt><dd><p>This property enables and disables error checking when SIP transactions overlap. If within a single dialog an INVITE request arrives while there is antoher transaction proceeding, the container will send a 491 error response. The default value is false.</p></dd></dl></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="bsssc-binary-SIP_Servlets_Server-Configuring_Logging"/>2.3.3. SIP Servlets Server Logging</h3></div></div></div><p>There are two separate levels of logging:</p><div class="itemizedlist"><ul><li><p>Logging at the container level, which can be configured using the <code class="filename">log4j.xml</code> configuration file, which is usually located in the container's <code class="filename">lib</code> directory.</p></li><li><p>Logging of the NIST SIP stack, which is configured in the <code class="literal">Connector</code> element of the container's <code class="filename">server.xml</code> configuration file.</p></li></ul></div><p>You can setup the logging so that the NIST SIP Stack will log into the container logs</p><p>To use LOG4J in NIST SIP Stack use the following, You need to define a category in <code class="filename">JBOSS_HOME/server/default/conf/jboss-log4j.xml</code> and set it to <code class="literal">off</code></p><div class="example"><a id="bsssc-Configuring_the_Stack_Logs_in_the_Container_log4j.xml"/><p class="title"><b>Example 2.3. Configuring the NIST SIP Stack to log into the Container's logs</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="XML"><!-- XML : generated by JHighlight v1.0 (http://jhighlight.dev.java.net) -->
<span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">category</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">name</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;gov.nist&quot;</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;</span><span class="xml_tag_name">priority</span><span class="xml_plain">&nbsp;</span><span class="xml_attribute_name">value</span><span class="xml_tag_symbols">=</span><span class="xml_attribute_value">&quot;OFF&quot;</span><span class="xml_tag_symbols">/&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="xml_tag_symbols">&lt;/</span><span class="xml_tag_name">category</span><span class="xml_tag_symbols">&gt;</span><span class="xml_plain"></span><br />
<span class="xml_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><br />
</pre></div></div><br class="example-break"/><p>So that this category is used in MSS you need to specify it in <code class="filename">JBOSS_HOME/server/default/conf/mss-sip-stack.properties</code> as well by adding this property <code class="literal">gov.nist.javax.sip.LOG4J_LOGGER_NAME=gov.nist</code> and setting this property <code class="literal">gov.nist.javax.sip.TRACE_LEVEL=LOG4J</code></p></div></div><div xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="footnotes"><br/><hr/><div xmlns="http://www.w3.org/1999/xhtml" class="footnote"><p><sup>[<a id="ftn.d0e723" href="#d0e723" class="para">1</a>] </sup>
			At this point in time, it is possible to run most <span class="application"><strong>Mobicents</strong></span> servers, such as the JAIN SLEE Server, using a Java 6 JRE or JDK. Be aware, however, that presently the XML Document Management Server does not run on Java 6. We suggest checking the Mobicents web site, forums or discussion pages if you need to inquire about the status of running the XML Document Management Server with Java 6.
		</p></div><div xmlns="http://www.w3.org/1999/xhtml" class="footnote"><p><sup>[<a id="ftn.d0e1499" href="#d0e1499" class="para">2</a>] </sup>
					Note that any other terminals which were opened prior to your having altered <code class="filename">.bashrc</code> will need to <code class="command">source</code>
						<code class="filename">~/.bashrc</code> as well should they require access to <code class="envar">JBOSS_HOME</code>.
				</p></div><div xmlns="http://www.w3.org/1999/xhtml" class="footnote"><p><sup>[<a id="ftn.d0e1903" href="#d0e1903" class="para">3</a>] </sup>
			At this point in time, it is possible to run most <span class="application"><strong>Mobicents</strong></span> servers, such as the JAIN SLEE Server, using a Java 6 JRE or JDK. Be aware, however, that presently the XML Document Management Server does not run on Java 6. We suggest checking the Mobicents web site, forums or discussion pages if you need to inquire about the status of running the XML Document Management Server with Java 6.
		</p></div></div></div><ul class="docnav"><li class="previous"><a accesskey="p" href="ittsss-Introduction_to_the_SIP_Servlets_Server.html"><strong>Prev</strong>Chapter 1. Introduction to the SIP Servlets Server</a></li><li class="up"><a accesskey="u" href="#"><strong>Top of page</strong></a></li><li class="home"><a accesskey="h" href="index.html"><strong>Front page</strong></a></li><li class="next"><a accesskey="n" href="sssicar-SIP_Servlets_Server-Application-Router.html"><strong>Next</strong>Chapter 3. Application Router</a></li></ul></body></html>